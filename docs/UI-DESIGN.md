# UI画面仕様

各画面の詳細なUIデザイン仕様をまとめます。  
**アプリ企画の全体像は [README.md](../README.md) の「アプリ企画概要」を参照してください。**

> **関連ドキュメント**: 
> - [README.md](../README.md) - アプリ企画概要・コンセプト・画面構成・遊び方
> - [ナビゲーション仕様](NAVIGATION.md) - 画面遷移・戻るボタンの挙動
> - [アクセシビリティ仕様](ACCESSIBILITY.md) - タップ領域・フォント・コントラスト
> - [データ設計](data-design.json) - データ構造

---

## アプリ企画概要（README 連動）

**ShakeFizz（シェイク・フィズ）** — スマホを炭酸缶に見立てて「振る」という身体的アクションに特化した、**ハイパーカジュアル・コンペティションゲーム**です。

### コア・コンセプト

- **直感的な遊び**: 「全力で振って、高く飛ばす」という誰にでもわかるルール。
- **デジタル・シズル感**: スマホを缶の窓に見立て、液体の揺れ、泡の弾け、手応えのある振動（ハプティクス）で圧倒的な没入感を提供。
- **公平な競争**: 缶の性能差を排除し、純粋な「振りの速さ・強さ」だけで競うスポーツ的なゲーム性。

### ゲームシステム（コアループ）

| ステップ | 内容 |
|----------|------|
| **エントリー** | 挑戦したい「缶（リーグ）」を選択。 |
| **シェイク** | 制限時間内にスマホを全力で振る。加速度センサーと連動し、振りに合わせて画面内の泡が激しくなり、振動が「シュワシュワ」から「バチバチ」へ変化。（※現行UI仕様では15秒タイムアタック） |
| **バースト（噴射）** | タイムアップ後、天に向けたスマホから炭酸が噴射！到達した高度（メートル）が記録となる。 |
| **リザルト** | 高度に応じたランキング順位と、獲得したバッジ（条件達成時）を表示。 |

### 競争とコレクション（メタゲーム）

- **缶別リーグランキング**: アイテム（ウルトラコーラ、ライムバースト等）ごとに独立したランキングが存在。
- **シーズン制と名誉報酬**: 過去の入賞履歴は「コレクション棚」に蓄積され、ユーザーの継続動機になります。

### マネタイズ戦略

- **リバイブ広告（追いシェイク）**: 終了直後に広告を見ることで、数秒間だけ追加で振って記録を伸ばせる仕組み。
- **スタミナ制限（炭酸補充）**: 一定回数プレイすると炭酸が切れ、時間回復または広告視聴でチャージ。
- **新リーグ（新缶）の解禁**: 特定の缶で遊ぶための権利を、広告視聴やゲーム内ポイントでアンロック。

---

## 1. 飲み物選択画面（Drink Selection）

**コンセプト**: ワクワク感を演出するスタート画面。暗い背景 × ネオンカラー（シアン・マゼンタ・イエロー）で、若者向けのエネルギッシュでモダンな雰囲気。README の「画面構成」に記載のとおり、**SELECT YOUR ULTIMATE FIZZ** で戦略性を匂わせ、画面上部に **YOUR BEST**（自己ベスト記録）を表示してモチベーション向上を図る。

### ヘッダー（画面上部）

| 要素 | 仕様 |
|------|------|
| 左 | 設定ボタン（歯車アイコン） |
| 中央 | ネオンシアン色のテキストで **「SHAKE FIZZ」** |

**注**: MVP では戻るボタン・ヘルプボタンは実装しません。シンプルな画面遷移フローを優先します。

### メインタイトル・説明・YOUR BEST

- **「SELECT YOUR」**（白・細字）の下に **「ULTIMATE FIZZ」**（ネオンシアン・太字）
- 画面上部（グリッド上またはヘッダー付近）に **YOUR BEST**（自己ベスト記録）を表示し、モチベーション向上とリプレイ意欲を刺激
- 説明文（白・細字）: *「Choose your weapon. Higher carbonation means more height, but less stability.」*  
  （武器を選べ。炭酸が多いほど高さは出るが、安定性は低い。）— 戦略性を匂わせる文言

### 飲み物選択グリッド（中央・2×2）

各カードは角丸・暗い背景で少し浮き出たカード形式。

| カード | 内容 | 特記事項 |
|--------|------|----------|
| **ULTRA COLA** | 赤いコカ・コーラ缶（水滴付き） | ネオンシアン枠、右上にマゼンタ「READY!」タグ。FIZZ 85%（シアンのプログレスバー） |
| **LIME BURST** | 緑の缶 | FIZZ 70%（黄色プログレスバー） |
| **BEAST FUEL** | 黒い細身缶（青い渦巻きロゴ） | FIZZ 95%（マゼンタプログレスバー） |
| **GINGER SHOCK** | グレースケール・ぼかし | 南京錠アイコン + 「RANK 5」でロック表示（アンロック要素） |

**FIZZゲージの仕様**:
- **FIZZ値**: 炭酸の強さ（スコアの出やすさと、振った時の泡の反応に影響）
- **視覚表現**: 缶の下にシンプルなプログレスバーを表示

### プライマリCTA

- **「START SHAKING」** ボタン: 画面幅いっぱい・角丸・**ネオンシアン（ブルー系）固定**・黒文字（または白文字）、右に矢印アイコン。選択した缶の色にはせず、統一されたブルーっぽいデザインとする。

### トーン・カラー

- 背景: 暗色（ほぼ黒）
- アクセント: ネオンシアン、マゼンタ、イエロー
- テキスト: 白（タイトル・ラベル）、ネオンで強調

### インタラクション・動作仕様

**ロック缶（GINGER SHOCK）のタップ時**:
- 缶カードをタップすると、画面中央に**半透明オーバーレイ + モーダルカード**を表示
- モーダル内容:
  - 南京錠アイコン（黄色・大）
  - 「LOCKED」（白・太字）
  - 「Reach Rank S to unlock this drink」（グレー・中）
  - 「OK」ボタン（ティール）でモーダルを閉じる

**缶選択時のフィードバック**:
- タップ時: 軽いハプティクス（UIImpactFeedbackGenerator.medium）
- 選択状態: 缶カードの**外枠が光る**（選択中は太いネオンシアン枠、未選択は薄い枠）
- 選択変更時: 前の缶の枠が消え、新しい缶の枠が光るアニメーション（0.2秒フェード）

**戻るボタン・ナビゲーション**:
- 左上の戻るボタン（元の仕様に戻す予定）: [ナビゲーション仕様](NAVIGATION.md)を参照
- フッター5番目のタブ「グループ」でグループ対戦モードに遷移

---

## 2. 安全警告画面（Safety Warning）

**コンセプト**: プレイ前の重要なステップ。スマホをしっかり持つよう促す**視認性の高い**警告画面。工事現場の立ち入り禁止を思わせる黄×黒ストライプとネオンカラーで、若者向けのモダンでサイバーパンク感のある警告を演出。

### 背景・全体

- 背景: 暗色（ほぼ黒に近いダークグレー）
- 上部・下部: **黄色と黒の斜めストライプ**の警告バー（画面幅いっぱい）で視覚的に区切り

### ヘッダー

| 要素 | 仕様 |
|------|------|
| 左上 | 丸枠内に感嘆符の**黄色い警告アイコン** |
| 右隣 | **「SAFETY FIRST!」**（大文字・太字・黄色） |
| 下 | 黄×黒の斜めストライプの細いライン（安全バー風） |

### メイン警告エリア（中央カード）

- **カード**: 角丸・ダークグレー・わずかに光る縁
- **上部中央**: 大きな**黄色の三角形の警告アイコン**（感嘆符入り）
- **メッセージ**
  - 「**HOLD TIGHT WITH**」（白・太字）
  - 「**BOTH HANDS!**」（黄・太字・さらに大きく）— 両手で持つことを強調
- **補足文**（グレー・細字）: *「Extreme shaking ahead. Do not drop or throw your device!」*  
  （激しい揺れが予想されます。デバイスを落としたり、投げたりしないでください！）
- **持ち方イラスト**
  - 横長の長方形内: 中央にスマホアイコン（左右に振動波）、その両脇に手のひら（手の甲）アイコン
  - スマホ＋楕円枠は**明るいシアン**で縁取り（ネオン効果）
  - 手は薄いグレー
- **追加ラベル**: 黄・太字で **「DANGER: HIGH VELOCITY」**

### フッター

- 黄×黒ストライプのライン（ヘッダーと同様）
- **「GOT IT!」** ボタン: 鮮やかなシアン・角丸・白い太字 — 警告を理解したことを確認するCTA
- **最下部**: 薄いグレーの小さな免責事項  
  *「ShakeFizz is not responsible for any device damage, cracked screens, or flying phones during gameplay. Play at your own risk.」* など

### トーン・カラー

- ダークグレー/黒（背景・カード）、黄（警告アイコン・強調テキスト・ストライプ）、白（本文）、明るいシアン（イラスト縁・ボタン）
- フォント: 太字サンセリフで視認性とエネルギッシュな印象
- **スキップ不可**（1回は表示必須）。進むには「GOT IT!」タップのみ

### 免責事項の改善・表示ルール

**免責事項の表示方法**（読みやすさ向上）:
- **最下部の長文を短縮**: 「ShakeFizz は本プレイによるデバイスの破損・落下等に責任を負いません。**詳細は利用規約**」（グレー・小さい）
- 「詳細は利用規約」部分は**タップ可能なリンク**（アンダーライン・ティール）で、利用規約画面（またはブラウザ）に遷移

**2回目以降の表示ルール**:
- **初回のみ必須**: 初回プレイ時は必ずこの画面を通る（スキップ不可）
- **2回目以降**: 
  - オプション A: 毎回表示（安全を最優先）
  - オプション B: 「TRY AGAIN」から再プレイ時は**スキップ**（同じセッション内）、アプリ再起動後は再度表示
  - **推奨**: オプション B（セッション内はスキップ、再起動後は再表示）— バランスがよい

---

## 3. プレイ画面（Play Screen）

**コンセプト**: 缶内部ビューで没入感を最大化。**数値表示は一切なし**。液体の揺れと泡のパーティクルで視覚的にフィードバック。結果への期待感を保ち、結果画面での驚きを最大化。

### 上部UI

| 要素 | 仕様 |
|------|------|
| 左上 | **「×」ボタン** — プレイ中断、飲み物選択画面へ戻る（**確認ダイアログあり**。[ナビゲーション仕様](NAVIGATION.md)の統一ルールに基づき、データ損失リスクがあるため） |
| 中央上部 | **「FLAVOR NEON LIME」** — 現在選択中の飲み物フレーバー表示（例: ULTRA COLA 等） |
| **タイマー（画面上部）** | トップバー直下に配置。円形プログレスバー＋残り時間（例: 00:12）をモノスペース・太字で表示。残り3秒で赤、5秒で黄に変化。ハプティクス・泡の荒れでフィードバック強化。 |

**注**: MVP では右上のグラフアイコンボタンは実装しません。プレイ画面はゲームプレイに集中するシンプルな設計とします。

### メイン表示エリア（全画面・缶内部ビュー）

**背景**: 飲み物の色で画面全体を塗りつぶし

- ULTRA COLA: ダークブラウン（#2D1810）
- LIME BURST: ライムグリーン（#32CD32）
- BEAST FUEL: ディープブルー（#0A1628）

**液体の揺れ（Sloshing）**:
- Accelerometer に連動して液体面が波打つ
- 振りの強さに応じて波の高さ・速度が変化
- 液体面は画面下部 50-70% の位置に表示
- 実装方法: SpriteKit または Canvas で波形アニメーション

**泡のパーティクルシステム（核心要素）**:

| 振りの強度 | 泡の発生量 | 上昇速度 | 視覚的効果 |
|------------|------------|----------|------------|
| **弱い** | 5-10個/秒 | ゆっくり（50pt/秒） | 小さな泡がゆらゆら上昇 |
| **普通** | 15-30個/秒 | 通常（100pt/秒） | 泡が連続的に発生 |
| **強い** | 40-60個/秒 | 高速（200pt/秒） | 泡が勢いよく噴き出す |
| **超強** | 80-120個/秒 | 爆発的（300pt/秒） | 画面全体が泡で満たされる、白い光のフラッシュ |

**泡の仕様**:
- サイズ: ランダム（3-12pt）
- 透明度: 0.6-1.0（ランダム）
- 色: 白または液体色の明るいバージョン
- 動き: 上昇しながら左右に微妙に揺れる（sin波）
- 寿命: 画面外に出たら消滅

**強振時の追加エフェクト**:
- 画面全体がわずかに振動（±2-3pt の揺れ）
- 白い光の短いフラッシュ（0.1秒）
- 泡の密度が最大化（画面が真っ白に近づく）
- ハプティクスフィードバック（0.2秒の強めの振動）

### 下部UI

**ゲーム操作ボタンのみ**を画面下部に配置。タイマーは上部に配置するため、下部は CTA に集中させる（README の画面構成に合わせる）。

#### 操作ボタン（画面下部）

**タップボタン（シェイク代替）**
- **配置**: 画面下部中央
- **ラベル**: **「TAP TO BUILD PRESSURE」**（白・太字・18-20pt）
- **役割**: 
  - シェイクできない環境（机の上に置いてプレイ、アクセシビリティ対応）でも遊べるように
  - タップするたびにシェイク動作をシミュレート（泡の発生、圧力の蓄積）
- **視覚的フィードバック**: 
  - タップ時にハプティクス（UIImpactFeedbackGenerator.medium）
  - 連続タップで泡の発生量が増加（シェイクと同等の効果）
- **スタイル**: 
  - 角丸ボタン（角丸 12pt）
  - 背景: 半透明のダークグレー（rgba(40,40,40,0.8)）
  - アクティブ時: ネオンシアンの枠が光る
  - パディング: 横 24pt、縦 16pt

**注**: POP THE TOPボタンは実装しない。15秒間のタイムアタック終了後、自動的に圧力が解放され、結果が決定される。タイマー表示は**画面上部**（トップバー直下）に配置する。

#### タイムアップ時

- 画面中央に大きく **「TIME UP!」** を表示（72pt・白・イタリック・マゼンタシャドウ）
- **結果ボタン**: 「TIME UP!」の下に **「VIEW RESULTS」** ボタン（ネオンマゼンタ・角丸・右矢印アイコン）

### ゲームフロー

**基本フロー（シェイク操作）**:
1. **カウントダウン**: 「3」「2」「1」（大きく表示、画面中央のオーバーレイ）
2. **15秒間のタイムアタック**: カウントダウン終了後、自動でゲーム開始
   - **シェイク操作**: デバイスを振って圧力を蓄積（Accelerometer検知）
   - **タップ操作**: 「TAP TO BUILD PRESSURE」ボタンを連打して圧力を蓄積（シェイクできない環境用）
3. **制限時間終了**: 15秒経過で自動的にシェイク検知が停止、圧力が自動的に解放され、スコアが決定される
4. **タイムアップ表示**: 「TIME UP!」を画面中央に大きく表示
5. **結果確認**: 「VIEW RESULTS」ボタンをタップして結果画面へ

**タップ操作フロー（シェイク代替）**:
- シェイクできない環境（机の上に置いてプレイ、アクセシビリティ対応）でも遊べるように
- 「TAP TO BUILD PRESSURE」ボタンを連打することで、シェイクと同等の効果を発揮
- タップの速度・頻度に応じて圧力が蓄積される

**注**: 必ず15秒間プレイし、タイムアップ後に自動で圧力が解放され、結果を見るフロー。ユーザーが任意のタイミングで終了する機能はない。

### トーン・インタラクション

- 飲み物の色を背景に使用（コーラなら茶色、ライムなら緑）
- 液体の揺れ（sloshing）を Accelerometer で検知してリアルタイム表示
- **泡のパーティクルが唯一のフィードバック** — 振るほど泡が増える直感的な体験
- **15秒間のタイムアタック**: カウントダウン（3・2・1）後、自動でゲーム開始。15秒間振り続ける
- 制限時間終了で自動的にシェイク検知停止、「TIME UP!」表示 → 「VIEW RESULTS」ボタンで結果画面へ

**設計思想**:
- ❌ 数値表示なし（予測噴射高、スコアなど）
- ✅ 視覚的フィードバックのみ（泡、液体の動き、タイマー、圧力ゲージ）
- ✅ 結果への期待感を最大化
- ✅ 「思いっきり振る楽しさ」に集中
- ✅ アクセシビリティ対応（タップ操作でシェイク代替可能）
- ✅ 操作の即時理解（ボタンの役割を明確に表示）

### カウントダウンとオフライン時の仕様

**カウントダウン「3・2・1」の表示**:
- **タイミング**: 安全警告で「GOT IT!」をタップした直後、プレイ画面に遷移と同時に開始
- **表示位置**: 画面中央（液体・泡の上にオーバーレイ）
- **スタイル**: 
  - 数字（3・2・1）: 144pt・白・極太・モノスペース、マゼンタのドロップシャドウ
  - 各数字を 1秒ずつ表示（フェードイン 0.2秒 → 表示 0.6秒 → フェードアウト 0.2秒）
  - 「GO!」: 同様のスタイルで 0.5秒表示後、フェードアウトして 15秒タイマー開始
- **音**: 「3・2・1」は短いビープ音、「GO!」は高音+重低音

**プレイ中断時の確認**（[ナビゲーション統一ルール](NAVIGATION.md)適用）:
- **左上「×」タップ時**: **確認ダイアログを表示**（統一ルール: データ損失リスクがあるため）
  - **タイトル**: 「プレイを中断しますか？」
  - **メッセージ**: 「スコアは記録されません」
  - **ボタン**: 
    - キャンセル（グレー・左）: 「続行」→ プレイ画面に留まる
    - 確認（ティール・右）: 「中断」→ 飲み物選択に戻る（スタッククリア）
- **実装**: `UIAlertController`（UIKit）または `.alert`（SwiftUI）を使用

**オフライン時の表示**:
- プレイ画面はオフラインでも実行可能（スコア計算はローカル）
- プレイ完了後、スコア送信時にオフラインの場合:
  - 結果画面上部に**ティール背景のバナー**を表示（画面幅いっぱい・3秒後に自動非表示）
  - 「オフライン。スコアは再接続時に送信されます」（白・アイコン: Wi-Fi オフ）
  - スコアはローカルに保存し、次回オンライン時にバックグラウンドで自動送信

---

## 4. 結果画面（Result Screen）

**コンセプト**: 達成した最高噴射高さとランクを大きく表示し、**SNSでシェアしやすい**レイアウト。README の「画面構成」のとおり **RANK S〜C** バッジ、達成スコア（m）、**NEW PERSONAL RECORD**、**TOP SPEED / TOTAL SHAKES**、**SHARE YOUR SPRAY**（X・Instagram・共有）、**TRY AGAIN** / **CHANGE DRINK** を提供。ダークテーマ × 光るティール・ピンクのアクセントで、達成感とエネルギッシュな印象を演出。

### トップバー

| 要素 | 仕様 |
|------|------|
| 左上 | ダークグレーの円形ボタン ＋ **白い「×」** — 飲み物選択画面へ戻る |
| 中央上部 | **「MISSION COMPLETE」**（薄いティール）、その下に **「SHAKEN!」**（大・太字・白）— クリア完了のメッセージ |

**注**: MVP では右上のグラフアイコンボタンは実装しません。ユーザーが結果画面から行えるアクションは「TRY AGAIN」「CHANGE DRINK」「SHARE」に限定します。

### メイン結果表示（中央）

- **ランクバッジ**: 角丸の長方形、**光るピンク/紫の枠**、白文字で **「RANK S」**（S〜C の高評価表示）
- **スコア**: **18.7** を大きく光るティール〜白の数字で表示、**m** は小さくティールで単位表示
- **低スコア時の対応（レビュアー指摘対応）**:
  - **問題点**: 「0.0m」は心理的にキツい、ユーザー体験的に痛い
  - **改善案C**: 「0.0m」の代わりに「—」と表示し、その下に「もっと振ってみよう！」と表示
- **新記録バッジ**: スコアの直下、ティール枠 ＋ 緑の星アイコン ＋ **「NEW PERSONAL RECORD」**（白） — **条件付き表示**: 実際に自己ベストを更新した場合のみ表示
- **前回ベスト**: その下に小さくグレーで *「Best: 17.5m last Tuesday」* など（UI実装では固定値プレースホルダー。バックエンド実装後にユーザーの実際のベスト記録を表示）

**情報階層化（レビュアー指摘対応）**:
- **問題点**: ランク、高さ、TOP SPEED、TOTAL SHAKESが一画面に表示され、情報過多で達成感が分散
- **改善案**: 
  - **初回 or 低スコア時**: 高さ＋ランクのみを大きく表示（第1階層）
  - **高スコア時 or 2回目以降**: 詳細スタッツ（TOP SPEED、TOTAL SHAKES）をフェードインで表示（第2階層）
  - **アニメーション**: 
    - 第1階層（ランク＋スコア）: 1-2秒間大きく表示
    - 第2階層（NEW RECORDバッジ）: 該当する場合のみアニメーション表示
    - 第3階層（統計・CTA）: フェードインで順次表示
- **実装判断**: **段階的表示を推奨**（達成感を最大化し、情報過多を解消）

### パフォーマンス統計（横並び・2枚のカード）

| カード | アイコン | ラベル | 値 |
|--------|----------|--------|-----|
| 左 | ティールの稲妻 | **TOP SPEED**（グレー） | **42 km/h**（大・白）— UI実装では固定値。将来的にShakeManagerから実際の最高速度を取得 |
| 右 | ティールの水滴 | **TOTAL SHAKES**（グレー） | **86**（大・白）— 実際のシェイク回数を表示 |

- 各カードは角丸の長方形

### シェア（SHARE YOUR SPRAY）

- **見出し**: 「SHARE YOUR SPRAY」（グレー・中央）
- **シェアボタン**: 3つの円形・ダークグレー、白いアイコン
  - X（Twitter/X）用 — UI実装では非機能、将来的にシェア機能を実装
  - Instagram 用 — UI実装では非機能、将来的にシェア機能を実装
  - アップロード/共有（上向き矢印）用 — UI実装では非機能、将来的にシステムシェアシートを実装

### 下部ナビゲーション・アクション

- **ページインジケーター**: 横並びの3点、中央がティールで点灯（必要に応じて複数結果に対応）
- **プライマリCTA**: **「TRY AGAIN」** — 大きく角丸、光るティール背景・黒文字、左に更新/やり直しアイコン
- **セカンダリCTA**: **「CHANGE DRINK」** — 角丸・ダークグレー、白文字、ボトル＋カクテルグラスのアイコン（飲み物選択へ）
- 最下部: iOS ホームインジケーター（細いグレー線）

### トーン・カラー

- 背景: 暗色（ダークテーマ）
- アクセント: 光るティール、ピンク/紫（ランクバッジ枠）、白・グレーで情報を階層化
- 達成感・派手さをネオン風の光で表現。スクショしやすい＝余白と情報のバランスを意識

### ナビゲーション・インタラクション仕様

**ページインジケーター（3点）の用途**:
- **現状**: 1プレイ = 1結果なので、ページインジケーターは**非表示**
- **将来対応**: 「連続プレイモード」「履歴閲覧」など、複数結果を横スワイプで切り替える機能を追加したときに表示
- **実装**: 現時点では非表示（または実装しない）

**× ボタンの行き先**:
- 左上「×」タップ → **飲み物選択画面**に戻る（[ナビゲーション仕様](NAVIGATION.md)参照）
- スタックをクリアして、新しいプレイの起点に戻る

**右上グラフボタンの行き先**（MVP では非実装）:
- 将来実装時: ランキング画面に遷移（デフォルトは「GLOBAL・今月」タブ）
- ランキング画面の「戻る」で結果画面に戻る（スタックに積む）

---

## 5. グローバルランキング画面（Global Ranking）

**コンセプト**: 他のユーザーと噴射高さを競い合う**リーダーボード**画面。README の「画面構成」のとおり **GLOBAL ELITE** リーダーボード、GLOBAL / FRIENDS 切り替え、シーズン終了カウントダウン、トップ3（大きく表示）、4位以降のリスト、最下部に自分の順位バナー（YOU・スコア・RANK）。暗い背景 × 鮮やかなティールのアクセントで、エネルギッシュでモダンな印象。

### ヘッダー

| 要素 | 仕様 |
|------|------|
| 左上 | 黒い円形ボタン ＋ **白い左向き矢印** — 戻る |
| 中央 | **「GLOBAL ELITE」**（白・太字・大文字サンセリフ）、「ELITE」の下にティールの短いアンダーライン |
| 右上 | 黒い円形ボタン ＋ **白いトロフィーアイコン** — 報酬 or シーズン履歴へ |

### グローバル / フレンド切り替え

- **セグメントコントロール**（中央・横並び）
  - **「GLOBAL」**: 選択時 — ティールの角丸ピル背景、白・太字・大文字
  - **「FRIENDS」**: 未選択 — 暗い角丸ピル上に白・太字・大文字

### シーズン終了カウントダウン

- **「SEASON ENDS IN」**（薄いティール）
- その下に **3つの円形アウトライン**（暗いティール枠）内に白い数字: **12**（HRS）／**45**（MIN）／**30**（SEC）
- 単位（HRS, MIN, SEC）は薄いティールで各円の下に表示

### トップ3表示（中央・大きく）

| 順位 | 配置・デザイン | 表示内容 |
|------|----------------|----------|
| **#1** | 中央・最も大きく、**太いティールの光る枠**、アバター上に**金色の星アイコン** | #1、ユーザー名（例: KingShaker）、スコア（例: 542.1m・ティール・太字） |
| **#2** | #1の左、やや小さい円形アバター、標準の暗い枠 | #2、ユーザー名（例: FizzMaster）、スコア（例: 510.8m・ティール） |
| **#3** | #1の右、やや小さい円形アバター、**オレンジ色の枠** | #3、ユーザー名（例: BubblePop）、スコア（例: 495.2m・ティール） |

- 各アバター下: 順位（白）→ ユーザー名（白・太字）→ スコア（ティール・太字・単位 m）

### ランキングリスト（4位以降・スクロール）

- **カード**: 横長・角丸・ダークグレーのピル/カード
- **各エントリ**: 左から
  - **順位**（白・数字）
  - **アバター**（小さい円形）
  - **ユーザー名**（白・太字）
  - **タイトル/ティア**（ユーザー名の下、色付き: 例「PRO SHAKER」「EXPERT」「ELITE」＝ティール、「RISING STAR」＝ピンク/マゼンタ）
  - **スコア**（右端、白・太字、例: 442.9m）、その下に小さく薄いグレーで「RECORD」

### 自分の順位バナー（最下部・固定）

- **バナー**: 幅広・角丸・**ティールで塗りつぶし**、目立つ配置
- **左**: 円形アバター（薄い茶系）、左上に **「YOU」** バッジ（白文字・ピンク/マゼンタ背景）
- **中央**: **ユーザー名**（白・太字・大文字、例: SODASLINGER）、その下に「Top 5% Globally」（白・小さい）
- **右側**: **ベストスコア**（白・太字、例: 385.4m）、その下に「YOUR BEST」（白・小さい）
- **最右**: **順位**（白・太字、例: #128）、その下に「RANK」（白・小さい）

### トーン・カラー

- 背景: 暗色（ほぼ黒）
- アクセント: 鮮やかなティール、白、オレンジ・ピンク/マゼンタ・薄い茶（アバター）を補助的に使用
- フォント: サンセリフ、太字でユーザー名・スコアを強調、タイトル・ラベルは大文字
- アイコン: 戻る矢印、トロフィー、星（1位用）
- 階層: トップ3 → リスト → 自分のバナーで視線を誘導

### ウィークリーランキングの表示とナビゲーション

**ウィークリーランキングの表示位置**:
- **オプション A（推奨）**: GLOBAL / FRIENDS の横に **「WEEKLY」タブ**を追加し、3つ並び（GLOBAL / FRIENDS / WEEKLY）にする
  - WEEKLY タブ選択時: 「今週のランキング」を表示。トップ3・リスト・自分のバナーの構成は GLOBAL と同様
  - 「SEASON ENDS IN」は**週の終了カウントダウン**に変更（日曜 23:59 まで）
- **オプション B**: GLOBAL 内で「今週 / 今月」の切り替えを追加（サブタブまたはドロップダウン）
- **MVP 実装**: まず GLOBAL（今月）のみ実装。WEEKLY は v1.1 以降で追加

**戻るボタンの行き先**:
- 左上「戻る」タップ → [ナビゲーション仕様](NAVIGATION.md)を参照（直前画面に戻る）
- 結果から来た場合: 結果に戻る
- 飲み物選択のフッターから来た場合: 飲み物選択に戻る

**オフライン時の表示**:
- ランキング画面を開いた際、ネットワーク接続がない場合:
  - リスト上部に**半透明グレーのバナー**（画面幅いっぱい）
  - 「オフライン。ランキングを取得できません」（白・Wi-Fi オフアイコン）
  - バナー右に「再試行」ボタン（ティール・小）
- キャッシュがある場合: キャッシュされたランキングを表示し、上部に「最終更新: 5分前」などのラベルを薄く表示

---

## 6. グループ対戦モード（Group Battle）

**コンセプト**: 人数を入力してルームを作り、同じグループ内でそれぞれゲームを行い、終了後に**グループ内の順位**を出すモード。友達同士で集まっての対戦に最適。

### フロー概要

1. **ルーム作成 or 参加** — 人数を入力（例: 2〜8人）してルーム作成、またはルームコード/QRで参加
2. **待機** — 参加者が揃うまで待機画面（例: 「3 / 5 人が参加」）
3. **各自プレイ** — 全員揃ったらスタート。各人が自分の端末で「飲み物選択 → 安全警告 → プレイ → 結果」を実施し、スコアがルームに送信される
4. **グループ結果** — 全員のプレイが終わったら、そのグループ内の順位（1位〜）を一覧表示

### 想定画面・UI要素

| ステップ | 画面 | 主な要素 |
|----------|------|----------|
| 入り口 | モード選択 or ホーム | **「GROUP BATTLE」** ボタン／アイコン（複数人アイコン） |
| ルーム作成 | 人数入力・ルーム作成 | **参加人数**の入力（スライダー or 数値 2〜8）、**「CREATE ROOM」**。作成後は **ルームコード（4〜6桁）** または **QRコード** を表示して他者に共有 |
| 参加 | ルーム参加 | コード入力欄 ＋ **「JOIN」**、または QR スキャン |
| 待機 | 待機ルーム | **「Waiting for players...」**、**3 / 5 joined** のような進捗。参加者一覧（ニックネーム or プレイヤー1, 2...）。ホストのみ **「START」** ボタン（全員揃ったら有効） |
| プレイ中 | 既存のプレイ画面 | 通常の「飲み物選択 → 安全警告 → プレイ → 結果」を各人が実施。結果画面で **「スコアをルームに送信」** で確定。**「待機中: あと2人」** のような表示も検討 |
| グループ結果 | グループ内ランキング | **「GROUP RESULTS」** タイトル。1位〜最下位まで、**順位・ニックネーム（or プレイヤー名）・スコア（m）** をリスト表示。1位はゴールド/ティールでハイライト。**「もう一度対戦」「ルームに戻る」** などのCTA |

### トーン・デザイン

- 既存のダーク × ネオン（ティール・シアン・マゼンタ）を踏襲
- 「グループ」「ルーム」感を出すため、複数人アイコン・ルームコード・待機中のアニメーションなどを活用
- グループ結果画面はグローバルランキングのリスト形式に近いが、**同一ルーム内の少人数**に特化した見やすさを優先

### 技術メモ（実装時）

- ルーム管理・参加者同期: Firebase Realtime Database / Firestore または簡易 WebSocket サーバー
- ルームコードは重複しにくいランダム文字列。有効期限（例: 10分）を設けるとよい
- 全員のスコアが揃ったタイミングで「グループ結果」画面へ遷移（プッシュ or ポーリング）

### 各画面の詳細UI仕様

**6-1. ルーム作成画面（Create Room）**

- **ヘッダー**: 左上「戻る」（飲み物選択へ）、中央「CREATE ROOM」（白・太字）
- **人数入力**: スライダー（2〜8人、デフォルト 4）またはステッパー（＋/−ボタン）
  - 現在値を大きく表示（例: 「5 PLAYERS」・ティール・太字）
- **「CREATE ROOM」ボタン**: 画面幅いっぱい・ティール・角丸
- **ルームコード表示**: 作成後、画面中央に大きくコード表示（例: 「AB3X9K」・モノスペース・白・72pt）
- **QRコード**: コードの下に QR 画像（200×200pt・白背景）
- **シェアボタン**: 「SHARE CODE」（ティール・角丸）でシステムシェアシート

**6-2. ルーム参加画面（Join Room）**

- **ヘッダー**: 左上「戻る」（飲み物選択へ）、中央「JOIN ROOM」（白・太字）
- **コード入力欄**: 6桁のテキストフィールド（大文字・モノスペース・中央揃え）
  - プレースホルダー: 「ENTER CODE」（グレー）
  - 入力時: 自動で大文字変換
- **「JOIN」ボタン**: ティール・角丸・画面幅
- **QR スキャン**: 「OR SCAN QR CODE」区切り線の下に、カメラアイコン + 「SCAN QR」ボタン（グレー・角丸）

**6-3. 待機ルーム画面（Waiting Room）**

- **ヘッダー**: 左上「×」（ルーム離脱）、中央「ROOM AB3X9K」（白・太字）
  - **ホストの場合**: 「×」タップ時に確認ダイアログ表示（[ナビゲーション統一ルール](NAVIGATION.md)適用）
    - タイトル: 「ルームを解散しますか？」
    - メッセージ: 「他の参加者が退出します」
    - ボタン: キャンセル（続行）/ 確認（解散してルーム作成/参加画面に戻る）
  - **参加者の場合**: 「×」タップ時に確認ダイアログなしで離脱（[ナビゲーション統一ルール](NAVIGATION.md)適用）
- **進捗**: 「Waiting for players...」（グレー）、その下に **「3 / 5」**（ティール・大・太字）
- **参加者リスト**: 縦スクロール、各エントリは「アバター（または番号）+ ニックネーム」（白）
  - 参加済み: 明るく表示、未参加: グレーアウト（「Player 4」「Player 5」など）
- **ホストマーク**: ホストの名前の横に王冠アイコン（黄色・小）
- **START ボタン**（ホストのみ）: 全員揃ったら有効化（ティール）、揃っていない場合は無効（グレー・半透明）
- **ルームコード再表示**: 下部に小さく「Code: AB3X9K」（タップでコピー）

**6-4. グループ結果画面（Group Results）**

- **ヘッダー**: 左上「×」（飲み物選択へ）、中央「GROUP RESULTS」（白・太字）
- **1位の特別表示**: トップの 1 位を大きく強調（金色の枠 + トロフィーアイコン）
- **リスト（2位〜）**: 順位・アバター・ニックネーム・スコア（m）を横長カードで表示
  - 自分の順位: ティール背景で強調
- **CTA**:
  - 「PLAY AGAIN」（ティール・画面幅）: 同じルームで再度プレイ（飲み物選択から開始）
  - 「LEAVE ROOM」（グレー・角丸）: ルームを離脱して飲み物選択へ

**エラー系の表示**

| エラー | 表示方法 |
|--------|----------|
| **ルーム満員** | 「JOIN」タップ時、画面下部から**赤いトーストバナー**（3秒表示）: 「Room is full」（白・感嘆符アイコン） |
| **コード不正** | 「JOIN」タップ時、入力欄が**赤く光る**アニメーション + トースト「Invalid room code」 |
| **ルームタイムアウト** | 待機中に有効期限（10分）を超えた場合、全員に**モーダル**表示: 「Room expired」（白・太字）+ 「OK」ボタン（ティール）でモーダルを閉じ、飲み物選択に戻る |
| **接続断（待機中）** | 画面上部に半透明バナー「接続が切れました。再接続中...」（グレー）、再接続成功で自動非表示 |

---

## デザイン原則（まとめ）

README の「デザイン原則（概要）」と同一です。

| キーワード     | 反映例                                               |
|----------------|------------------------------------------------------|
| エネルギッシュ | ネオンカラー、派手なランク表示、動きのあるUI           |
| 没入感         | 缶内部ビュー、液体の揺れ、暗めのプレイ画面             |
| 若者向け       | ポップな色、SNSシェア、ランキング競争                 |
| 安全           | 視認性の高い警告画面（スキップ不可）                   |

**主な機能**（没入型プレイ、自己ベスト表示、ランクシステム、パフォーマンス統計、安全重視、シェア、グローバルランキング、グループ対戦モード）の一覧は [README.md](../README.md) の「主な機能」セクションを参照。

---

## 画面遷移イメージ

**通常モード**（README「画面遷移」と同一）

```
[飲み物選択] → [安全警告] → [プレイ（15秒タイムアタック）] → [結果]
      ↑                                                        ↓
      └────────────────────────────────────────────────────────┘
                        (CHANGE DRINK / TRY AGAIN)
```

**ゲームフロー詳細**（README「遊び方」に対応）:
1. 好きな飲み物を選ぶ → **START SHAKING**
2. 安全警告を読んで **GOT IT!**
3. 3秒のカウントダウン後、15秒間思いっきり振る（タイマーは画面上部に表示）
4. 制限時間終了後、**「結果を見る」**（VIEW RESULTS）で結果画面へ
5. 最高噴射高さ（m）とランク（S〜C）を競う → 結果をシェア or ランキングで競争。**TRY AGAIN** / **CHANGE DRINK**

**グループ対戦モード**

```
[モード選択] → [ルーム作成 or 参加] → [待機ルーム] → [START]
                                                          ↓
[グループ結果] ← … ← [結果] ← [プレイ] ← [安全警告] ← [飲み物選択]
     ↑                    （各プレイヤーが順に or 並行でプレイ）
     └── もう一度対戦 / ルームに戻る
```

---

*詳細なナビゲーション仕様については [NAVIGATION.md](NAVIGATION.md) を参照してください。*
